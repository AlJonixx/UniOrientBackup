{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <meta name="description" content="Smarthr - Bootstrap Admin Template">
		<meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern, accounts, invoice, html5, responsive, CRM, Projects">
        <meta name="author" content="Dreamguys - Bootstrap Admin Template">
        <meta name="robots" content="noindex, nofollow">
        <title>Attendance - Uni Orient</title>
		
		<!-- Favicon -->
       <link href="{% static '/home/assets/img/uni-logo-transparent.png' %}" rel="icon">
		
		<!-- Bootstrap CSS -->
        <link rel="stylesheet" href="{% static '/admin/assets/css/bootstrap.min.css' %}">
		
		<!-- Fontawesome CSS -->
        <link rel="stylesheet" href="{% static '/admin/assets/css/font-awesome.min.css' %}">
		
		<!-- Lineawesome CSS -->
        <link rel="stylesheet" href="{% static '/admin/assets/css/line-awesome.min.css' %}">
		
		<!-- Chart CSS -->
		<link rel="stylesheet" href="{% static '/admin/assets/plugins/morris/morris.css' %}">

        <!-- Datatable CSS -->
		<link rel="stylesheet" href="{% static '/admin/assets/css/dataTables.bootstrap4.min.css' %}">

        <!-- Datetimepicker CSS -->
		<link rel="stylesheet" href="{% static '/admin/assets/css/bootstrap-datetimepicker.min.css' %}">
		
		<!-- Select2 CSS -->
		<link rel="stylesheet" href="{% static '/admin/assets/css/select2.min.css' %}">
		
		<!-- Main CSS -->
        <link rel="stylesheet" href="{% static '/admin/assets/css/style.css' %}">

		<script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/webrtc-adapter/3.3.3/adapter.min.js"></script>
    </head>
    <body class="account-page" onload="mytime()">
	
		<!-- Main Wrapper -->
        <div class="main-wrapper">
			<div class="account-content">
				{% comment %} <a href="job-list.html" class="btn btn-primary apply-btn">Apply Job</a> {% endcomment %}
				<div class="container">
				
					<!-- Account Logo -->
					<div class="account-logo">
						<a href="index.html"><img src="{% static '/home/assets/img/uni-logo-transparent.png' %}" alt="Logo Uni Orient"></a>
					</div>
					<!-- /Account Logo -->	

					<div class="account-box">
						<div class="account-wrapper">
							<h3 class="account-title">Attendance</h3>
							<br>
							<h3 style="text-align:center">{% now "jS F Y" %}</h3>
							<h3 style="text-align:center;" id="timehere"></h3>
							<br>
							<div>
								<video id="preview" width="100%"></video>
							</div>
							<br>
							<h3 style="text-align:center;">Scan QR Code Here</h3>
							<br>
							<form id="attendanceForm" method="POST">
                            {% csrf_token %}					                           
                            <div class="InOut form-group form-focus select-focus">
                                <select name="LoginOptions" id="LoginOptions" class="select floating">                       
									<option value="1">Time In</option>                            
									<option value="0">Time out</option>  
                                </select>   
                                <label class="focus-label">Attendance</label>								
                            </div>

							<div class="lunchBreak form-group form-focus select-focus">
								<select name="LucnhOptions" id="LucnhOptions" class="select floating">                       
									<option value="2">Break Out</option>                            
									<option value="3">Break In</option>  
                                </select>   
                                <label class="focus-label">Attendance</label>
							</div> 

                                  
                        
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label class="col-form-label">Employee ID <span class="text-danger">*</span></label>
                                        <input id="employeeID" name="employeeID" class="form-control" type="text" readonly>										
                                    </div>
                                </div>
                                </div>
                                <br>
                               <!-- Button -->
                                <div class="form-group text-center">
									
									<button id="myBtn" class="btn btn-primary account-btn" name="TimeLogin" type="submit">Login</button>
								</div>
								
                                </form>
							<!-- /Account Form -->
							
 
                    </div>
                        
							<!--Message-->
							<div>
                    			{% for message in messages %}
								<div class="alert alert-success text-center" role="alert">
									<strong>{{ message }}</strong>									
								</div>
                    			{% endfor %}
                			</div>
							<!-- Drop Down -->
						
					</div>
				</div>
			</div>
        </div>
		<!-- /Main Wrapper -->
		
		<!-- jQuery -->
        <script src="{% static '/admin/assets/js/jquery-3.5.1.min.js' %}"></script>

		<!-- Bootstrap Core JS -->
        <script src="{% static '/admin/assets/js/popper.min.js' %}"></script>
        <script src="{% static '/admin/assets/js/bootstrap.min.js' %}"></script>

		<!-- Slimscroll JS -->
		<script src="{% static '/admin/assets/js/jquery.slimscroll.min.js' %}"></script>
		
		<!-- Select2 JS -->
		<script src="{% static '/admin/assets/js/select2.min.js' %}"></script>
		
		<!-- Datatable JS -->
		<script src="{% static '/admin/assets/js/jquery.dataTables.min.js' %}"></script>
		<script src="{% static '/admin/assets/js/dataTables.bootstrap4.min.js' %}"></script>
		
		<!-- Datetimepicker JS -->
		<script src="{% static '/admin/assets/js/moment.min.js' %}"></script>
		<script src="{% static '/admin/assets/js/bootstrap-datetimepicker.min.js' %}"></script>

		<!-- Custom JS -->
		<script src="{% static '/admin/assets/js/app.js' %}"></script>

		
		
		<script>
			function mytime(){
				var d=new Date();
				ap="am";	
				h=d.getHours();
				m=d.getMinutes();
				s=d.getSeconds();
				if (h>11) { ap = "pm"; }
				if (h>=12 && h<=14) { 
					$('.InOut').hide(); 
				} else {				
					$('.lunchBreak').hide(); 
				}
				if (h>12) { h = h-12; }			
				if (h==0) { h = 12; }
				if (m<10) { m = "0" + m; }
				if (s<10) { s = "0" + s; }
				document.getElementById('timehere').innerHTML=h + ":" + m + ":" + s + " " + ap;			
				t=setTimeout('mytime()',500);			
			}			

			/*setTimeout(function(){
				window.location.reload(1);
			 }, 10000);*/	
			 function refreshAt(hours, minutes, seconds) {
				var now = new Date();
				var then = new Date();
			
				if(now.getHours() > hours ||
				   (now.getHours() == hours && now.getMinutes() > minutes) ||
					now.getHours() == hours && now.getMinutes() == minutes && now.getSeconds() >= seconds) {
					then.setDate(now.getDate() + 1);
				}
				then.setHours(hours);
				then.setMinutes(minutes);
				then.setSeconds(seconds);
			
				var timeout = (then.getTime() - now.getTime());
				setTimeout(function() { window.location.reload(true); }, timeout);
			}

			$(document).ready(function() { refreshAt(12,0,0); });
			$(document).ready(function() { refreshAt(14,0,0); });
		</script>		

		<script>
			{% comment %} let scanner = new Instascan.Scanner({ video: document.getElementById('preview')});
		    var audio = document.getElementById("timeAudio");
        
			Instascan.Camera.getCameras().then(function(cameras){
				if(cameras.length > 0 ){
					scanner.start(cameras[0]);

				}else {
					alert("No Cameras Found");
				}
			}).catch(function(e){
				console.error(e);
			});

			scanner.addListener('scan',function(c){
				document.getElementById('employeeID').value=c;
				document.getElementById("myBtn").click();
			
			}); {% endcomment %}

var app = new Vue({
  el: '#app',
  data: {
    scanner: null,
    activeCameraId: null,
    cameras: [],
    scans: []
  },
  mounted: function () {
    var self = this;
    self.scanner = new Instascan.Scanner({ video: document.getElementById('preview'), scanPeriod: 5 });
    self.scanner.addListener('scan', function (content, image) {
     			document.getElementById('employeeID').value=c;
				document.getElementById("myBtn").click();
    });
    Instascan.Camera.getCameras().then(function (cameras) {
      self.cameras = cameras;
      if (cameras.length > 0) {
        self.activeCameraId = cameras[0].id;
        self.scanner.start(cameras[0]);
      } else {
        console.error('No cameras found.');
      }
    }).catch(function (e) {
      console.error(e);
    });
  },
  methods: {
    formatName: function (name) {
      return name || '(unknown)';
    },
    selectCamera: function (camera) {
      this.activeCameraId = camera.id;
      this.scanner.start(camera);
    }
  }
});
		</script>

    </body>
</html>